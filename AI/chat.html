<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chat OLM</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/40440288c0.js" crossorigin="anonymous"></script>

  <link rel="Shortcut icon" type="x-icon" href="/images/blehfile.png">
  <meta content="OkemoVail" property="og:title">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    /* 1. GLOBAL THEME VARIABLES (Simplified) */
    :root {
      /* LIGHT MODE DEFAULTS (Used when .dark is NOT present) */
      --color-background: #FAFAFA; /* Very light gray for body/fixed bars */
      --color-surface: #FFFFFF; /* Pure white for input bar */
      --color-text: #171717; /* Very dark gray for text */
      --color-neutral-border: #e5e7eb; /* Light border (neutral-200) */
      --color-user-bubble: #E5E7EB; /* Subtle off-white for user message (neutral-200) */
      --color-icon-neutral: #6b7280; /* Neutral-500 for non-primary icons */
      --color-icon-primary-bg: var(--color-text); /* AI logo background */
      --color-icon-primary-text: var(--color-surface); /* AI logo text */
    }

    /* DARK MODE OVERRIDES */
    .dark {
      --color-background: #171717;
      --color-surface: #262626; /* neutral-800 dark */
      --color-text: #F5F5F5;
      --color-neutral-border: #3f3f46; /* neutral-700 dark border */
      --color-user-bubble: #3f3f46; /* neutral-700 dark for user message */
      --color-icon-neutral: #a3a3a3; /* neutral-400 */
      --color-icon-primary-bg: var(--color-text); /* F5F5F5 */
      --color-icon-primary-text: #171717;
    }


    /* Global containers inherit the uniform background */
    body {
      background-color: var(--color-background);
      color: var(--color-text);
      font-family: 'Inter', sans-serif;
      transition: background-color 0.3s, color 0.3s;
    }
    
    /* Fixed header and footer bar backgrounds */
    #fixed-header-wrapper, .fixed.bottom-0 {
        background-color: var(--color-background);
    }
    
    /* Input container uses a slightly distinct background color and border */
    #input-bar-container {
        background-color: var(--color-surface);
        box-shadow: 0 2px 5px -1px rgb(0 0 0 / 0.1); /* Subtle shadow for lift */
        border: 1px solid var(--color-neutral-border);
    }

    /* 2. CUSTOM ICON COLOR LOGIC */
    .ai-logo-placeholder {
      min-width: 32px; min-height: 32px; border-radius: 9999px;
      background-color: var(--color-icon-primary-bg); 
      color: var(--color-icon-primary-text); 
      display: flex; align-items: center; justify-content: center;
      font-size: 1rem; font-weight: 700;
    }

    /* Target all icons that should be neutral */
    .chat-toolbox i, #menu-toggle i, #plus-icon, .icon-neutral {
        color: var(--color-icon-neutral); 
        transition: color 0.3s;
    }

    /* --- General UI Clean-up and Animation --- */
    .chat-scroll { overflow-x: hidden; background-color: transparent !important; }
    @keyframes loading-line {
      0% { transform: translateX(-100%) scaleX(0.1); }
      50% { transform: translateX(0%) scaleX(0.5); }
      100% { transform: translateX(100%) scaleX(0.1); }
    }
    .loading-line-animation {
      animation: loading-line 2s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      transform-origin: left;
    }
    
    /* Dropdown Toggles */
    #menu-toggle i, #plus-icon { transition: transform 0.3s ease-in-out; }
    #menu-toggle.active i { transform: rotate(180deg); }
    #plus-menu-toggle.active #plus-icon { transform: rotate(45deg); }
    
    /* Input Container Layout (Simplified Grid) */
    #input-bar-container {
      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto 1fr; /* Row 1 for preview, Row 2 for input/buttons */
    }
    #file-preview-container { 
      grid-column: 1 / span 2; 
      grid-row: 1; 
      padding: 10px 16px 0; 
      z-index: 10; 
      display: none; /* Controlled by JS, but useful default */
    }
    #okemo-input { 
        grid-row: 2; 
        grid-column: 1; 
        padding: 12px 16px; 
        min-height: 48px; 
        max-height: 200px; 
        background-color: transparent;
        border-radius: 2rem; /* Ensure rounded corners */
    }
    #s-wrapper { 
        grid-row: 2; 
        grid-column: 2; 
        display: flex; 
        align-items: flex-end; 
        gap: 4px; 
        margin-right: 4px; 
        margin-bottom: 4px;
        padding-left: 8px; /* Add padding to separate from text input */
    }
    #empty-chat-prompt {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
      text-align: center; width: 100%; max-width: 400px; transition: opacity 0.3s ease-in-out;
    }
    
    /* Message Styling (Removed unnecessary border-bottom from .ai-message-row) */
    .ai-message-row {
      padding: 12px 0; 
      /* No border-bottom for AI message row */
    }
    .ai-message-row > div:nth-child(2) { 
      max-width: calc(100% - 40px); 
      line-height: 1.6; 
    }
    
    /* User Message Bubble */
    .user-message-row > div {
      background-color: var(--color-user-bubble); 
      color: var(--color-text); /* Inherit the main text color */
      border-radius: 12px; 
    }
    
    /* --- CURSOR ANIMATION FIX --- */

    /* Keyframes for the blinking effect (opacity toggle) */
    @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
    }

    /* Style for the cursor element itself (using the block character) */
    .blinking-cursor {
        /* Ensure the cursor is visually styled */
        font-size: 1.1em; /* Slightly larger size */
        font-weight: 700;
        color: var(--color-text); /* Use the main text color */
        
        /* Apply the blinking animation */
        animation: blink 0.7s infinite step-end;
        
        /* Ensure it doesn't wrap lines right after the last word */
        display: inline-block;
        vertical-align: middle;
        margin-left: 2px;
    }
    
  </style>
</head>
<body class="min-h-screen font-inter flex flex-col transition-colors duration-300">
  
  <div id="disclaimer-modal" class="fixed inset-0 bg-neutral-900/40 dark:bg-neutral-800/70 flex items-center justify-center z-50 transition-opacity duration-300 hidden backdrop-blur-sm opacity-0">
    <div class="bg-white dark:bg-neutral-800 p-6 rounded-[2rem] shadow-2xl max-w-sm w-full mx-4 transform transition-all duration-300">
      <h3 class="text-2xl font-bold mb-4 text-neutral-900 dark:text-white">Okemo Disclaimer</h3>
      <div class="text-neutral-600 dark:text-neutral-400 mb-6 text-sm space-y-3">
        <p>OkemoLLM is currently in public beta. All of its generated content may be inaccurate, incomplete, or biased.</p>
        <p class="font-semibold text-neutral-800 dark:text-neutral-300">By clicking Agree:</p>
        <ul class="list-disc list-inside ml-2 space-y-1">
          <li>Your input is logged and used to improve the model.</li>
          <li>This service is extremely unsecure.</li>
          <li>Your conversations may or may not be shared around the internet.</li>
        </ul>
        <p class="mt-4 text-base font-bold text-red-600">
          <i class="fa-solid fa-triangle-exclamation mr-1"></i> PLEASE AVOID SHARING SENSITIVE INFORMATION.
        </p>
      </div>
      
      <div class="flex items-center mb-4">
        <input type="checkbox" id="dont-show-again" class="w-4 h-4 text-neutral-600 bg-neutral-100 dark:bg-neutral-700 border-none rounded focus:ring-neutral-500 accent-neutral-500">
        <label for="dont-show-again" class="ml-2 text-sm font-medium text-neutral-700 dark:text-neutral-300">Don't show this again</label>
      </div>

      <div class="flex gap-4">
        <button
          id="disclaimer-agree"
          class="w-full py-2 bg-neutral-900 dark:bg-white text-white dark:text-black font-semibold rounded-xl hover:bg-neutral-800 dark:hover:bg-neutral-100 transition duration-300"
        >
          <i class="fas fa-check"></i>
        </button>
        <a href="OkemoLLM.html"
          class="block w-full py-2 border border-neutral-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-neutral-800 dark:text-white font-semibold rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-700 transition duration-300 text-center"
          aria-label="Disagree"
        >
          <i class="fas fa-times"></i>
        </a>
      </div>
    </div>
  </div>
  
  <div id="bad-feedback-modal"
    class="fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden z-[1000] transition-opacity duration-300 opacity-0">
    <div class="bg-white dark:bg-neutral-800 p-6 rounded-[2rem] shadow-2xl max-w-sm w-full mx-4 relative">
      <h2 class="text-lg font-semibold mb-3 dark:text-white">Bad Response Feedback</h2>
      <p class="text-sm text-neutral-600 dark:text-neutral-300 mb-4">
        What should the response have been instead?
      </p>
      <textarea id="bad-feedback-input"
        class="w-full h-24 border border-neutral-300 dark:border-neutral-700 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-neutral-500 dark:bg-neutral-900 dark:text-white"
        placeholder="Enter your suggested correct response..."></textarea>
      <div class="flex justify-end gap-3 mt-4">
        <button id="cancel-bad-feedback"
          class="px-4 py-2 rounded-[2rem] bg-neutral-200 hover:bg-neutral-300 dark:bg-neutral-700 hover:dark:bg-neutral-900 dark:text-white text-sm transition"
          aria-label="Cancel">
          <i class="fas fa-arrow-left mr-1"></i> Cancel
        </button>
        <button id="submit-bad-feedback"
          class="px-4 py-2 bg-neutral-900 dark:bg-white text-white dark:text-black font-semibold rounded-xl hover:bg-neutral-800 dark:hover:bg-neutral-100 transition duration-300"
          aria-label="Submit Feedback">
          <i class="fas fa-paper-plane mr-1"></i> Submit
        </button>
      </div>
    </div>
  </div>
  
  <div id="update-notes-modal" class="fixed inset-0 bg-neutral-900/40 dark:bg-neutral-800/70 flex items-center justify-center z-50 transition-opacity duration-300 opacity-0 hidden backdrop-blur-sm">
    <div class="bg-white dark:bg-neutral-800 p-6 rounded-[2rem] shadow-2xl max-w-sm w-full mx-4 transform transition-all duration-300">
      <h3 class="text-2xl font-bold mb-4 text-neutral-900 dark:text-white flex items-center">
        <i class="fa-solid fa-bell text-neutral-600 dark:text-neutral-400 mr-2"></i> What's New!
      </h3>
      <div class="text-neutral-600 dark:text-neutral-400 mb-6 text-sm space-y-4">
        <h4 class="text-lg font-semibold text-neutral-800 dark:text-white">
          Version 0.2.0 - November 2025
        </h4>
        <ul class="list-disc list-inside ml-2 space-y-2 text-neutral-700 dark:text-neutral-400">
          <li>Stability Fixes: Corrected critical 4D tensor and repetition errors in the backend generation sampler.</li>
          <li>Training Refactor: Training is now manual (via the Feedback button or Training panel) for better stability.</li>
          <li>Persona Update: Model personality adjusted to be more comprehensive and ChatGPT-like.</li>
          <li>Feedback Feature: Bad Feedback button now correctly captures the desired response and sends it for manual training.</li>
        </ul>
      </div>
      
      <div class="flex items-center mb-4">
        <input type="checkbox" id="notes-dont-show-again" class="w-4 h-4 text-neutral-600 bg-neutral-100 dark:bg-neutral-700 border-none rounded focus:ring-neutral-500 accent-neutral-500">
        <label for="notes-dont-show-again" class="ml-2 text-sm font-medium text-neutral-700 dark:text-neutral-300">Don't show this version's notes again</label>
      </div>

      <button
        id="update-notes-close"
        class="w-full py-2 bg-neutral-900 dark:bg-white text-white dark:text-black font-semibold rounded-xl hover:bg-neutral-800 dark:hover:bg-neutral-100 transition duration-300"
        aria-label="Close Updates"
      >
        <i class="fas fa-check mr-1"></i>
      </button>
    </div>
  </div>

  <div id="fixed-header-wrapper" class="fixed top-0 left-0 right-0 z-30 backdrop-blur-md transition-colors duration-300 border-b border-neutral-200 dark:border-neutral-800">
    <div class="w-full mx-auto max-w-2xl px-4 sm:px-8">
      <header class="py-3 flex items-center justify-between relative">
        <div class="flex items-center relative">
          <a href="OkemoLLM.html" id="okemo-title" class="text-xl font-semibold cursor-pointer text-neutral-900 dark:text-white">
            OLM
          </a>
          <span id="update-note-badge" class="update-badge hidden"></span>
          <button id="menu-toggle" class="ml-1 text-base p-1 rounded-full duration-300" aria-label="Toggle Menu">
            <i class="fa-solid fa-caret-down transition duration-150 transform icon-neutral" id="menu-icon"></i>
          </button>
        </div>
        
        <a href="#" id="new-chat-link-header" class="px-5 h-9 flex items-center justify-center rounded-[2rem] bg-neutral-200 dark:bg-neutral-700 hover:bg-neutral-300 dark:hover:bg-neutral-600 text-black dark:text-white transition-all duration-300" aria-label="Start New Chat" data-tooltip-content="New Chat">
          <h1 class="font-medium pr-1 text-sm">New</h1><i class="fa-regular fa-message text-sm"></i>
        </a>

        <div id="okemo-dropdown" class="absolute left-0 top-[calc(100%+5px)] w-48 bg-white dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl shadow-xl z-10 p-1 transform opacity-0 scale-y-0 transition-all duration-200 ease-out origin-top">
          <a href="#" id="new-chat-dropdown-2" class="relative flex items-center px-3 py-2 text-neutral-800 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition duration-300">
            <i class="fas fa-code-branch mr-2 w-4 text-center icon-neutral"></i> OLM 1
          </a>
          <div class="my-1 border-t border-neutral-100 dark:border-neutral-700"></div>
          <a href="#" id="show-update-notes" class="relative flex items-center px-3 py-2 text-neutral-800 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition duration-300">
            <i class="fa-solid fa-note-sticky mr-2 w-4 text-center icon-neutral"></i> Update Notes
          </a>
        </div>
      </header>
    </div>
  </div>

  <div class="w-full px-4 sm:px-8 pt-[62px] pb-[100px] flex-1 flex flex-col min-h-0 mx-auto max-w-2xl relative">
    
    <div id="empty-chat-prompt" class="text-3xl select-none text-neutral-500 dark:text-neutral-400">
      How can I help you today?
    </div>
    
    <div id="okemo-chat" class="chat-scroll overflow-y-auto flex-1 relative">
      </div>
  </div>

  <div class="fixed bottom-0 left-0 right-0 z-20 transition-colors duration-300">
    <div class="w-full max-w-xl px-4 sm:px-14  mx-auto pb-4 pt-2">
      
      <div id="okemo-status" class="min-h-5 text-sm text-neutral-500 dark:text-neutral-400 mb-1"></div>
      
      <div id="input-bar-container" class="rounded-3xl w-full relative"> 
        
        <div id="file-preview-container" class="transition-all duration-300">
        </div>
        
        <textarea
          id="okemo-input"
          placeholder="Message OLM..."
          rows="1"
          class="rounded-3xl focus:outline-none text-base resize-none h-auto min-h-[48px] max-height:60 overflow-hidden bg-transparent transition-all duration-300 border-none focus:ring-0 text-neutral-900 dark:text-white"
        ></textarea>
        
        <div id="s-wrapper">
          
          <div id="input-dropdown" class="absolute right-0 bottom-[calc(100%+10px)] w-48 bg-white dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 rounded-xl shadow-xl z-10 p-1 transform opacity-0 scale-y-0 transition-all duration-200 ease-out origin-bottom-right">
            
            <button id="web-search-option" class="w-full relative flex items-center px-3 py-2 text-neutral-800 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition duration-300">
              <i class="fa-solid fa-globe mr-2 w-4 text-center icon-neutral"></i> Web Search
            </button>

            <button id="add-image-option" class="w-full relative flex items-center px-3 py-2 text-neutral-800 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition duration-300">
              <i class="fa-solid fa-image mr-2 w-4 text-center icon-neutral"></i> Upload Photo
            </button>
            
            <button id="new-feature-option" class="w-full relative flex items-center px-3 py-2 text-neutral-800 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition duration-300">
              <i class="fa-solid fa-paperclip mr-2 w-4 text-center icon-neutral"></i> Attach File
            </button>
          </div>
          
          <button
            id="plus-menu-toggle"
            class="cursor-pointer rounded-full w-8 h-9 flex items-center justify-center transition duration-300 transform"
            aria-label="Open Input Menu"
            data-tooltip-content="Attach/Options"
          >
            <i id="plus-icon" class="fa-solid fa-plus text-lg transition-all duration-300"></i>
          </button>

          <button id="okemo-send"
            class="cursor-pointer rounded-full bg-neutral-900 dark:bg-white hover:bg-neutral-800 dark:hover:bg-neutral-100 active:bg-black dark:active:bg-neutral-300 text-white dark:text-black w-10 h-10 flex items-center justify-center transition duration-300"
            aria-label="Send Message"
            data-tooltip-content="Send"
          >
            <i class="fa-solid fa-arrow-up text-sm"></i>
          </button>
        </div>
      </div>
      
      <input type="file" id="file-upload-input" class="hidden" accept=".pdf,.doc,.docx,.txt">
      <input type="file" id="image-upload-input" class="hidden" accept="image/*">
      
      <div class="text-xs text-center text-neutral-500 dark:text-neutral-400 mt-2">
        <i class="fa-solid fa-lightbulb mr-1"></i> OLM will most likely make mistakes, please double check.
      </div>
      
    </div>
  </div>
  <script>
    const htmlElement = document.documentElement;
    const themeKey = 'theme';

    function loadTheme() {
      const storedTheme = localStorage.getItem(themeKey);

      if (storedTheme === 'light') {
        htmlElement.classList.remove('dark');
      } else if (storedTheme === 'dark') {
        htmlElement.classList.add('dark');
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        htmlElement.classList.add('dark');
      } else {
        htmlElement.classList.remove('dark');
      }
      
      document.dispatchEvent(new Event('themeLoaded'));
    }

    document.addEventListener('DOMContentLoaded', loadTheme);
  </script>

<script type="module" src="chat.js"></script>
</body>
</html>